<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <title>QR æ‰«æå™¨</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="manifest" href="manifest.json" />
  <style>
    body{font-family:system-ui,Roboto,Helvetica,Arial,sans-serif;background:#fff;color:#222;text-align:center;margin:0;padding:1rem}
    #reader{max-width:400px;margin:1rem auto;border:2px solid #007bff;border-radius:6px}
    button{margin:.5rem;padding:.6rem 1.2rem;font-size:1rem;background:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer}
    button:hover{background:#0056b3}
    ul{max-height:40vh;overflow:auto;text-align:left;padding-left:1.5rem}
    li{word-break:break-all;margin:.25rem 0}
    /* ===== å³ä¸Šè§’å–‡å­æŒ‰é’® ===== */
    #soundToggle{
      position:fixed;top:.5rem;right:.5rem;width:44px;height:44px;
      font-size:26px;border:none;background:transparent;cursor:pointer;
      color:#666;transition:color .2s;
    }
    #soundToggle.allow{color:#007bff}
  </style>
</head>
<body>
  <!-- å³ä¸Šè§’å–‡å­ -->
  <button id="soundToggle" title="å…è®¸/ç¦æ­¢æç¤ºéŸ³">ğŸ”Š</button>

  <h2>QR æ‰«æå™¨</h2>
  <div id="reader"></div>
  <button onclick="exportCSV()">å¯¼å‡º CSV</button>
  <button onclick="clearHis()">æ¸…ç©ºè®°å½•</button>
  <ul id="list"></ul>

  <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
  <script>
    /* ---------- æ•°æ® ---------- */
    const get=()=>JSON.parse(localStorage.getItem('qr')||'[]');
    const set=d=>localStorage.setItem('qr',JSON.stringify(d));

    /* ---------- å»é‡è¡¨ ---------- */
    const dupMap=new Map();

    /* ---------- é•¿"æ»´"æç¤ºéŸ³(â‰ˆ0.2s) ---------- */
    const beep=new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YUQGAACBhYqFbF1fdJivrNepw4qMg2tVUWxEi9N5wLKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsrKzsr
